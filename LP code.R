library(lpSolve)

obj.fun <- 
  c(160*4, 160*4, 160*4, 160*4, 160*3, 160*3, 160*3, 160*3, 160*2, 160*2, 160*2, 160*2, 160, 160, 160, 160,
    150*4, 150*4, 150*4, 150*4, 150*3, 150*3, 150*3, 150*3, 150*2, 150*2, 150*2, 150*2, 150, 150, 150, 150,
    140*4, 140*4, 140*4, 140*4, 140*3, 140*3, 140*3, 140*3, 140*2, 140*2, 140*2, 140*2, 140, 140, 140, 140,
    130*4, 130*4, 130*4, 130*4, 130*3, 130*3, 130*3, 130*3, 130*2, 130*2, 130*2, 130*2, 130, 130, 130, 130,
    120*4, 120*4, 120*4, 120*4, 120*3, 120*3, 120*3, 120*3, 120*2, 120*2, 120*2, 120*2, 120, 120, 120, 120,
    110*4, 110*4, 110*4, 110*4, 110*3, 110*3, 110*3, 110*3, 110*2, 110*2, 110*2, 110*2, 110, 110, 110, 110,
    100*4, 100*4, 100*4, 100*4, 100*3, 100*3, 100*3, 100*3, 100*2, 100*2, 100*2, 100*2, 100, 100, 100, 100,
    90*4, 90*4, 90*4, 90*4, 90*3, 90*3, 90*3, 90*3, 90*2, 90*2, 90*2, 90*2, 90, 90, 90, 90,
    80*4, 80*4, 80*4, 80*4, 80*3, 80*3, 80*3, 80*3, 80*2, 80*2, 80*2, 80*2, 80, 80, 80, 80,
    70*4, 70*4, 70*4, 70*4, 70*3, 70*3, 70*3, 70*3, 70*2, 70*2, 70*2, 70*2, 70, 70, 70, 70,
    60*4, 60*4, 60*4, 60*4, 60*3, 60*3, 60*3, 60*3, 60*2, 60*2, 60*2, 60*2, 60, 60, 60, 60,
    50*4, 50*4, 50*4, 50*4, 50*3, 50*3, 50*3, 50*3, 50*2, 50*2, 50*2, 50*2, 50, 50, 50, 50,
    40*4, 40*4, 40*4, 40*4, 40*3, 40*3, 40*3, 40*3, 40*2, 40*2, 40*2, 40*2, 40, 40, 40, 40,
    30*4, 30*4, 30*4, 30*4, 30*3, 30*3, 30*3, 30*3, 30*2, 30*2, 30*2, 30*2, 30, 30, 30, 30,
    20*4, 20*4, 20*4, 20*4, 20*3, 20*3, 20*3, 20*3, 20*2, 20*2, 20*2, 20*2, 20, 20, 20, 20,
    10*4, 10*4, 10*4, 10*4, 10*3, 10*3, 10*3, 10*3, 10*2, 10*2, 10*2, 10*2, 10, 10, 10, 10)

obj.fun.matrix <- matrix(obj.fun, 16, 16)
obj.fun.matrix  

constr3 <- matrix(0, 32, 256)

m <- 16
n <- 16

for(i in 1:m){
  for(j in 1:n){
    constr3[i, j + (i-1)*16] <- 1
    constr3[16+i, (i-1) + 16*j - 15] <- 1
  }
}

constr3.dir <- c(rep("=", 32))
constr4.dir <- c(rep("=", 36))
constr5.dir <- c(rep("=", 64))

a<-0
for(i in 1:64){
  a[i] <- c(1)
}

rhs5 <- a
rhs3

prod.model2 <- lp("min", obj.fun, constr3, constr3.dir, rhs3, compute.sens = TRUE)
prod.model2$objval

prod.model2$solution
model_matrix <- matrix(prod.model2$solution, 16,16)
model_matrix


vari.f <- 0

for(i in 1:1024){
  vari.f[i] <- 1
}
vari.f
vari.amount <- c(488, 414, 383, 331, 329, 318, 309, 197, 174, 169, 157, 156, 154, 
                 140, 138, 133, 132, 130, 128, 125, 124, 123, 119, 116, 115, 112,
                 106, 105, 84, 83, 83, 81)
vari2.amount <- c(19, 10, 6, 7,
                  156, 125, 46, 81,
                  329, 116, 6, 46,
                  11, 42, 19, 9,
                  8, 3, 13, 4,
                  119, 50, 49, 488,
                  112, 84, 0, 33,
                  76, 10, 6, 11)

weight.selves <- c(4,4,4,4,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,1,1,1,1,2,2,2,2,3,3,3,3)
weight.selves2 <- c(13,14,15,16,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,1,2,3,4,5,6,7,8,9,10,11,12)

weight.freq <- 
  c(0.033942559, 0.036553525, 
    0.039164491, 0.041775457,
    0.002610966, 0.005221932,
    0.007832898, 0.010443864,
    0.013054830, 0.015665796,
    0.018276762, 0.020887728,
    0.023498695, 0.026109661,
    0.028720627, 0.031331593,
    0.033942559, 0.036553525,
    0.039164491, 0.041775457,
    0.002610966, 0.005221932,
    0.007832898, 0.010443864,
    0.013054830, 0.015665796,
    0.018276762, 0.020887728,
    0.023498695, 0.026109961,
    0.028720627, 0.031331593)

amount.freq <- 
  c(6.971428571, 6.179104478,
    9.575, 4.189873418,
    3.427083333, 11.77777778,
    9.967741935, 3.456140351, 
    4.578947368, 2.640625,
    2.483870968, 6.038461538, 
    5.032258065, 3.111111111, 
    8.625,8.866666667, 
    3, 4.642857143,
    3.2, 2.5,
    4.96, 3.617647059,
    2.586956522, 2.416666667,
    2.446808511, 2.333333333,
    1.766666667, 5.833333333,
    2.27027027, 2.441176471,
    3.074074074, 8.1)

for(i in 1:32){
  for(j in 1:32){
    vari.f[ 32 * (i-1) + j] <- vari.f[ 32 * (i-1) + j] * vari2.amount[i] * weight.selves2[j]
  }
}

obj.fun.double <- vari.f
obj.fun.double
constr5 <- matrix(0, 64, 1024)

m <- 32
n <- 32

for(i in 1:m){
  for(j in 1:n){
    constr5[i, j + (i-1)*32] <- 1
    constr5[32+i, (i-1) + 32*j - 31] <- 1
  }
}
constr5[34,]
prod.model <- lp("min", obj.fun.double, constr5, constr5.dir, rhs5, compute.sens = TRUE)
prod.model$objval
prod.model.sol <- matrix(prod.model$solution, 32, 32)
prod.model.sol

library(xlsx)
setwd("C://Users/xgh02/Desktop")
write.xlsx(prod.model.sol, file="batch4.xlsx", 
           sheetName="first", col.names=TRUE, row.names=FALSE, append=TRUE)
getwd()
